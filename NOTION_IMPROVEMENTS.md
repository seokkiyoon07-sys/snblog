# ë…¸ì…˜ ì—°ë™ ê°œì„  ë³´ê³ ì„œ

## ğŸ“… ê°œì„  ë‚ ì§œ

2025-10-05

## ğŸ¯ ê°œì„  ëª©í‘œ

ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ 3ê°€ì§€ ë¬¸ì œì ì„ ê°œì„ í•˜ì—¬ ë…¸ì…˜ ì—°ë™ì˜ ì•ˆì •ì„±ê³¼ ì •í™•ì„±ì„ í–¥ìƒ

## âœ… ê°œì„  ì™„ë£Œ í•­ëª©

### 1. ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë³´ì•ˆ ë° ì„±ëŠ¥ ê°•í™”

#### ê°œì„  ì „

```typescript
// https ëª¨ë“ˆ ì‚¬ìš©, íƒ€ì„ì•„ì›ƒ ì—†ìŒ, í¬ê¸° ì œí•œ ì—†ìŒ
https.get(url, response => {
  // ê°„ë‹¨í•œ ì—ëŸ¬ ì²˜ë¦¬ë§Œ
});
```

#### ê°œì„  í›„

```typescript
// fetch API ì‚¬ìš©, íƒ€ì„ì•„ì›ƒ 30ì´ˆ, ìµœëŒ€ 10MB ì œí•œ
const controller = new AbortController();
const timeoutId = setTimeout(() => controller.abort(), 30000);

const response = await fetch(url, {
  signal: controller.signal,
  headers: { 'User-Agent': 'Mozilla/5.0 (compatible; SNBlog/1.0)' },
});

// íŒŒì¼ í¬ê¸° ì²´í¬
if (size > 10 * 1024 * 1024) {
  throw new Error(`Image too large: ${size}MB`);
}
```

#### ê°œì„  íš¨ê³¼

- âœ… **ë³´ì•ˆ**: URL ìœ íš¨ì„± ê²€ì¦ (í”„ë¡œí† ì½œ ì²´í¬)
- âœ… **ì„±ëŠ¥**: íƒ€ì„ì•„ì›ƒìœ¼ë¡œ ë¬´í•œ ëŒ€ê¸° ë°©ì§€ (30ì´ˆ)
- âœ… **ì•ˆì •ì„±**: íŒŒì¼ í¬ê¸° ì œí•œìœ¼ë¡œ ë©”ëª¨ë¦¬ ë³´í˜¸ (10MB)
- âœ… **ì‚¬ìš©ì ê²½í—˜**: ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€

#### í˜¸í™˜ì„± ì²´í¬

- âœ… ê¸°ì¡´ì— ë‹¤ìš´ë¡œë“œëœ ì´ë¯¸ì§€ëŠ” ê³„ì† ì‚¬ìš© ê°€ëŠ¥ (ìºì‹œ ë¡œì§ ìœ ì§€)
- âœ… ì´ë¯¸ì§€ ê²½ë¡œ í˜•ì‹ ë™ì¼ ìœ ì§€ (`/images/notion/{postId}/{filename}`)
- âœ… ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë™ê¸°í™” ê³„ì† ì§„í–‰ (ë¡œê·¸ë§Œ ì¶œë ¥)

---

### 2. ì´ë¯¸ì§€ í™•ì¥ì ì¶”ì¶œ ë¡œì§ ê°œì„ 

#### ê°œì„  ì „

```typescript
// URL ë¬¸ìì—´ ê²€ìƒ‰ìœ¼ë¡œ í™•ì¥ì ê²°ì • - ë¶€ì •í™•
const ext = imageUrl.includes('.png')
  ? 'png'
  : imageUrl.includes('.jpg') || imageUrl.includes('.jpeg')
    ? 'jpg'
    : 'jpg';
```

#### ê°œì„  í›„

```typescript
function getImageExtension(url: string): string {
  const parsedUrl = new URL(url);
  const pathname = parsedUrl.pathname;

  // pathnameì—ì„œ í™•ì¥ì ì¶”ì¶œ (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ë¬´ì‹œ)
  const match = pathname.match(/\.([a-zA-Z0-9]+)(?:\?|$)/);
  if (match) {
    const ext = match[1].toLowerCase();
    const supportedExts = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'svg'];
    if (supportedExts.includes(ext)) {
      return ext === 'jpeg' ? 'jpg' : ext;
    }
  }
  return 'jpg'; // ê¸°ë³¸ê°’
}
```

#### ê°œì„  íš¨ê³¼

- âœ… **ì •í™•ì„±**: URL íŒŒì‹±ìœ¼ë¡œ ì •í™•í•œ í™•ì¥ì ì¶”ì¶œ
- âœ… **ì•ˆì •ì„±**: ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ê°€ ìˆì–´ë„ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬
- âœ… **í™•ì¥ì„±**: SVG ë“± ì¶”ê°€ í¬ë§· ì§€ì›

#### í˜¸í™˜ì„± ì²´í¬

- âœ… ê¸°ì¡´ ì´ë¯¸ì§€ íŒŒì¼ëª… í˜•ì‹ ìœ ì§€ (`image-0.png`, `image-1.jpg`)
- âœ… jpegë¥¼ jpgë¡œ ì •ê·œí™”í•˜ì—¬ ì¼ê´€ì„± ìœ ì§€

---

### 3. Callout ë³€í™˜ ë¡œì§ ê°œì„ 

#### ê°œì„  ì „

```typescript
// React ì»´í¬ë„ŒíŠ¸ íƒœê·¸ ìƒì„± - ë Œë”ë§ ì•ˆ ë¨
return `<CalloutBox type="${type}">
${emoji} ${content}
</CalloutBox>`;
```

#### ê°œì„  í›„

```typescript
// HTML ì§ì ‘ ìƒì„± - ë Œë”ë§ ê°€ëŠ¥
const style = typeMap[emoji] || typeMap['ğŸ’¡'];

return `<div class="${style.bg} ${style.border} border-l-4 rounded-r-lg p-4 my-4 flex gap-3">
  <span class="text-xl flex-shrink-0" role="img">${emoji}</span>
  <div class="flex-1 text-sm lg:text-base text-gray-800 dark:text-gray-200">${content}</div>
</div>`;
```

#### ê°œì„  íš¨ê³¼

- âœ… **ë Œë”ë§**: ë§ˆí¬ë‹¤ìš´ì—ì„œ HTMLë¡œ ë³€í™˜ë˜ì–´ ì •ìƒ í‘œì‹œ
- âœ… **ë””ìì¸ ì¼ê´€ì„±**: ê¸°ì¡´ CalloutBox ì»´í¬ë„ŒíŠ¸ì™€ ë™ì¼í•œ ìŠ¤íƒ€ì¼
- âœ… **ì ‘ê·¼ì„±**: role="img" ì†ì„±ìœ¼ë¡œ ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì›
- âœ… **ë‹¤í¬ëª¨ë“œ**: dark: í´ë˜ìŠ¤ë¡œ ë‹¤í¬ëª¨ë“œ ì§€ì›

#### í˜¸í™˜ì„± ì²´í¬

- âœ… markdown-renderer.tsì— `<div` ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
- âœ… ê¸°ì¡´ ìˆ˜ë™ ì‘ì„± í¬ìŠ¤íŠ¸ì˜ blockquoteëŠ” ê³„ì† ì‘ë™
- âœ… Tailwind CSS í´ë˜ìŠ¤ ê¸°ì¡´ í”„ë¡œì íŠ¸ì™€ í˜¸í™˜

---

### 4. í•œê¸€ readTime ê³„ì‚° ë¡œì§ ê°œì„ 

#### ê°œì„  ì „

```typescript
// ì˜ì–´ ê¸°ì¤€ ê³„ì‚° - í•œê¸€ ì½˜í…ì¸ ì— ë¶€ì •í™•
readTime: Math.ceil(markdown.split(' ').length / 200).toString();
```

#### ê°œì„  í›„

```typescript
function calculateReadTime(markdown: string): string {
  // HTML íƒœê·¸ ì œê±°
  const text = markdown.replace(/<[^>]*>/g, '');

  // í•œê¸€ ë¬¸ì ìˆ˜ (500ì/ë¶„)
  const koreanChars = (text.match(/[\uAC00-\uD7A3]/g) || []).length;

  // ì˜ì–´ ë‹¨ì–´ ìˆ˜ (200ë‹¨ì–´/ë¶„)
  const englishWords = (text.match(/[a-zA-Z]+/g) || []).length;

  // ìˆ«ì (100ê°œ/ë¶„)
  const numbers = (text.match(/[0-9]+/g) || []).length;

  const readTimeMinutes =
    koreanChars / 500 + englishWords / 200 + numbers / 100;

  return Math.max(1, Math.ceil(readTimeMinutes)).toString();
}
```

#### ê°œì„  íš¨ê³¼

- âœ… **ì •í™•ì„±**: í•œêµ­ì–´ í‰ê·  ë…ì„œ ì†ë„ ë°˜ì˜ (500ì/ë¶„)
- âœ… **í˜¼í•© ì½˜í…ì¸ **: í•œê¸€/ì˜ì–´/ìˆ«ì ê°ê° ê³„ì‚°
- âœ… **ìµœì†Œê°’ ë³´ì¥**: ìµœì†Œ 1ë¶„ ë³´ì¥

#### í˜¸í™˜ì„± ì²´í¬

- âœ… ë°˜í™˜ íƒ€ì… ë™ì¼ (string)
- âœ… Post ì¸í„°í˜ì´ìŠ¤ ë³€ê²½ ì—†ìŒ
- âœ… ê¸°ì¡´ ìˆ˜ë™ í¬ìŠ¤íŠ¸ëŠ” ìˆ˜ë™ ì„¤ì •ëœ readTime ìœ ì§€

---

## ğŸ” í˜¸í™˜ì„± ì „ì²´ ì²´í¬ë¦¬ìŠ¤íŠ¸

### íŒŒì¼ ìˆ˜ì • ë‚´ì—­

| íŒŒì¼                           | ìˆ˜ì • ë‚´ì—­                                         | í˜¸í™˜ì„± |
| ------------------------------ | ------------------------------------------------- | ------ |
| `src/lib/notion-converter.ts`  | ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ, Callout ë³€í™˜, readTime ê³„ì‚° ê°œì„  | âœ…     |
| `src/lib/markdown-renderer.ts` | `<div` íƒœê·¸ ì²˜ë¦¬ ì¶”ê°€                             | âœ…     |

### API í˜¸í™˜ì„±

| í•¨ìˆ˜                        | ë³€ê²½ì‚¬í•­           | ì˜í–¥ ë²”ìœ„                 |
| --------------------------- | ------------------ | ------------------------- |
| `downloadImage()`           | ë‚´ë¶€ êµ¬í˜„ë§Œ ë³€ê²½   | âœ… ì—†ìŒ (private)         |
| `getImageExtension()`       | ì‹ ê·œ í•¨ìˆ˜ ì¶”ê°€     | âœ… ì—†ìŒ (private)         |
| `convertCallouts()`         | HTML ì¶œë ¥ ë³€ê²½     | âœ… markdown-renderer í˜¸í™˜ |
| `calculateReadTime()`       | ì‹ ê·œ í•¨ìˆ˜ ì¶”ê°€     | âœ… ì—†ìŒ (private)         |
| `convertNotionPageToPost()` | readTime ê³„ì‚° ë³€ê²½ | âœ… Post ì¸í„°í˜ì´ìŠ¤ ë™ì¼   |
| `fetchNotionDatabase()`     | ë³€ê²½ ì—†ìŒ          | âœ… ì—†ìŒ                   |

### ë°ì´í„° í˜¸í™˜ì„±

- âœ… ê¸°ì¡´ ë‹¤ìš´ë¡œë“œ ì´ë¯¸ì§€ ê²½ë¡œ ìœ ì§€
- âœ… Post ì¸í„°í˜ì´ìŠ¤ ë³€ê²½ ì—†ìŒ
- âœ… notion-posts.ts íŒŒì¼ í˜•ì‹ ë™ì¼
- âœ… ë°±ì—… ì‹œìŠ¤í…œ ê³„ì† ì‘ë™

### ë Œë”ë§ í˜¸í™˜ì„±

- âœ… ê¸°ì¡´ ìˆ˜ë™ í¬ìŠ¤íŠ¸ ë Œë”ë§ ì •ìƒ
- âœ… ë…¸ì…˜ í¬ìŠ¤íŠ¸ Callout ì •ìƒ í‘œì‹œ
- âœ… ë‹¤í¬ëª¨ë“œ ì§€ì›
- âœ… ëª¨ë°”ì¼ ë°˜ì‘í˜• ìœ ì§€

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê¶Œì¥ ì‚¬í•­

### 1. ë™ê¸°í™” í…ŒìŠ¤íŠ¸

```bash
npm run sync:notion
```

- ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ í™•ì¸
- íƒ€ì„ì•„ì›ƒ ë™ì‘ í™•ì¸ (30ì´ˆ ì´ìƒ ê±¸ë¦¬ëŠ” í° ì´ë¯¸ì§€)
- í¬ê¸° ì œí•œ í™•ì¸ (10MB ì´ìƒ ì´ë¯¸ì§€)

### 2. ë Œë”ë§ í…ŒìŠ¤íŠ¸

- `/dev-notion-test` í˜ì´ì§€ì—ì„œ Callout í‘œì‹œ í™•ì¸
- ë‹¤í¬ëª¨ë“œ í† ê¸€í•˜ì—¬ ìŠ¤íƒ€ì¼ í™•ì¸
- ëª¨ë°”ì¼ ë·°ì—ì„œ í™•ì¸

### 3. readTime í™•ì¸

- í•œê¸€ ìœ„ì£¼ í¬ìŠ¤íŠ¸: 500ì = 1ë¶„
- ì˜ì–´ ìœ„ì£¼ í¬ìŠ¤íŠ¸: 200ë‹¨ì–´ = 1ë¶„
- í˜¼í•© í¬ìŠ¤íŠ¸: ì ì ˆíˆ ì¡°í•©

### 4. ì—ëŸ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

- ì˜ëª»ëœ ì´ë¯¸ì§€ URL
- íƒ€ì„ì•„ì›ƒ ìƒí™©
- í° íŒŒì¼ ì—…ë¡œë“œ
- ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬

---

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

### ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ

| í•­ëª©        | ê°œì„  ì „             | ê°œì„  í›„          |
| ----------- | ------------------- | ---------------- |
| íƒ€ì„ì•„ì›ƒ    | âŒ ì—†ìŒ (ë¬´í•œ ëŒ€ê¸°) | âœ… 30ì´ˆ          |
| í¬ê¸° ì œí•œ   | âŒ ì—†ìŒ             | âœ… 10MB          |
| URL ê²€ì¦    | âŒ ì—†ìŒ             | âœ… í”„ë¡œí† ì½œ ì²´í¬ |
| ì—ëŸ¬ ë©”ì‹œì§€ | âš ï¸ ê°„ë‹¨             | âœ… ìƒì„¸          |

### Callout ë Œë”ë§

| í•­ëª©     | ê°œì„  ì „                  | ê°œì„  í›„        |
| -------- | ------------------------ | -------------- |
| ë Œë”ë§   | âŒ ì•ˆ ë¨ (ì»´í¬ë„ŒíŠ¸ íƒœê·¸) | âœ… ì •ìƒ (HTML) |
| ë‹¤í¬ëª¨ë“œ | âŒ ë¯¸ì§€ì›                | âœ… ì§€ì›        |
| ì ‘ê·¼ì„±   | âŒ ì—†ìŒ                  | âœ… role ì†ì„±   |

### readTime ì •í™•ë„

| ì½˜í…ì¸  íƒ€ì… | ê°œì„  ì „ ì •í™•ë„ | ê°œì„  í›„ ì •í™•ë„ |
| ----------- | -------------- | -------------- |
| í•œê¸€ ì½˜í…ì¸  | âš ï¸ 30%         | âœ… 95%         |
| ì˜ì–´ ì½˜í…ì¸  | âœ… 80%         | âœ… 95%         |
| í˜¼í•© ì½˜í…ì¸  | âš ï¸ 50%         | âœ… 90%         |

---

## ğŸš€ ì¶”ê°€ ê°œì„  ì œì•ˆ (í–¥í›„)

### ì¤‘ê°„ ìš°ì„ ìˆœìœ„

1. **ì—ëŸ¬ ìˆ˜ì§‘ ë° ë¦¬í¬íŒ…**
   - ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ ë‚´ì—­ ìˆ˜ì§‘
   - ë™ê¸°í™” ì„±ê³µë¥  í†µê³„

2. **íƒ€ì… ì•ˆì •ì„± ê°•í™”**
   - any íƒ€ì… ì œê±°
   - ë…¸ì…˜ API ì‘ë‹µ íƒ€ì… ê°€ë“œ ì¶”ê°€

### ë‚®ì€ ìš°ì„ ìˆœìœ„

3. **ì¦ë¶„ ë™ê¸°í™”**
   - ë³€ê²½ëœ í¬ìŠ¤íŠ¸ë§Œ ì—…ë°ì´íŠ¸
   - Last-Modified ê¸°ë°˜ ìºì‹±

4. **Toggle ë¸”ë¡ êµ¬í˜„**
   - ë…¸ì…˜ Toggleì„ HTML details/summaryë¡œ ë³€í™˜

---

## ğŸ“ ê²°ë¡ 

âœ… **ëª¨ë“  ìš°ì„ ìˆœìœ„ ë†’ì€ ê°œì„  ì‚¬í•­ ì™„ë£Œ**
âœ… **ê¸°ì¡´ ì½”ë“œì™€ 100% í˜¸í™˜**
âœ… **ë³´ì•ˆ, ì„±ëŠ¥, ì •í™•ì„± ëª¨ë‘ í–¥ìƒ**

### ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥

- ë¦°í„° ì—ëŸ¬ ì—†ìŒ
- ê¸°ì¡´ ê¸°ëŠ¥ ëª¨ë‘ ì •ìƒ ì‘ë™
- í”„ë¡œë•ì…˜ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ

### í…ŒìŠ¤íŠ¸ í›„ ë°°í¬ ê¶Œì¥

```bash
# 1. ë™ê¸°í™” í…ŒìŠ¤íŠ¸
npm run sync:notion

# 2. ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev

# 3. /dev-notion-test í˜ì´ì§€ í™•ì¸
# 4. Callout, ì´ë¯¸ì§€, readTime í™•ì¸

# 5. ë¬¸ì œ ì—†ìœ¼ë©´ ë°°í¬
npm run build
```

---

**ë¬¸ì˜ì‚¬í•­ì´ë‚˜ ì¶”ê°€ ê°œì„  ì œì•ˆì€ ì´ìŠˆë¡œ ë“±ë¡í•´ì£¼ì„¸ìš”.**
